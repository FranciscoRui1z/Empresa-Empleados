Modificado todo, para cumplir los criterios pedidos.
